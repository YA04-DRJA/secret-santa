<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thank You! â€“ I90 Deep Creek Secret Santa 2025</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .event-banner {
            background: linear-gradient(135deg, #c41e3a 0%, #8b1a2e 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 8px 20px rgba(196, 30, 58, 0.3);
            color: white;
            text-align: center;
        }

        .event-banner h2 {
            font-size: 32px;
            margin-bottom: 25px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .event-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .event-item {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .event-item-full {
            grid-column: 1 / -1;
            background: rgba(255, 140, 0, 0.9);
            padding: 20px;
            border-radius: 15px;
            font-size: 20px;
            font-weight: bold;
        }

        .event-deadline {
            grid-column: 1 / -1;
            background: rgba(220, 20, 60, 0.9);
            padding: 20px;
            border-radius: 15px;
            font-size: 22px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .potluck-section {
            background: #fff9e6;
            border: 3px solid #ff8c00;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .potluck-section h3 {
            color: #ff8c00;
            font-size: 24px;
            margin-bottom: 15px;
            text-align: center;
        }

        .food-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .food-option {
            background: white;
            border: 2px solid #ff8c00;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .food-option:hover {
            background: #fff3cd;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 140, 0, 0.3);
        }

        .food-option input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.2);
        }

        .food-option label {
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }

        .dress-code-box {
            background: linear-gradient(135deg, #165b33 0%, #0f3d22 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border: 3px dashed #ffd700;
        }

        .dress-code-box h3 {
            color: #ffd700;
            margin-bottom: 10px;
        }

        .warning-box {
            background: #fff3cd;
            border: 3px solid #c41e3a;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            text-align: center;
        }

        .warning-box h3 {
            color: #c41e3a;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .submit-potluck-btn {
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 140, 0, 0.4);
        }

        .submit-potluck-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 140, 0, 0.6);
        }

        .percentage-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-top: 8px;
            overflow: hidden;
        }

        .percentage-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff8c00, #ff6b00);
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .percentage-text {
            display: block;
            text-align: center;
            margin-top: 5px;
            font-size: 12px;
            font-weight: bold;
            color: #ff8c00;
        }

        @media (max-width: 768px) {
            .event-grid, .food-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- CHRISTMAS TREES -->
    <div class="tree tree-left">ğŸ„</div>
    <div class="tree tree-right">ğŸ„</div>

    <div class="container">
        <!-- THANK YOU CARD -->
        <div class="card" style="display: block;">
            <div class="ribbon"></div>
            
            <!-- EMPTY RED HEADER - JUST DECORATION -->
            <div class="christmas-header"></div>

            <div class="main-title">
                <div class="title-big">ğŸ‰ YOU'RE IN! ğŸ‰</div>
                <div class="santa-center">ğŸ…</div>
                <div class="title-small">Welcome to Secret Santa 2025!</div>
            </div>

            <!-- EVENT DETAILS BANNER -->
            <div class="event-banner">
                <h2>ğŸ„ MARK YOUR CALENDARS! ğŸ„</h2>
                <div class="event-grid">
                    <div class="event-item">
                        ğŸ“… December 19th, 2025
                    </div>
                    <div class="event-item">
                        ğŸ• 1:00 PM
                    </div>
                    <div class="event-item">
                        ğŸ“ Main Office
                    </div>
                    <div class="event-item">
                        ğŸ’° Budget: ~$25
                    </div>
                    <div class="event-item-full">
                        ğŸ• Potluck Style: Bring a dish to share!
                    </div>
                    <div class="event-deadline">
                        â° Draw Date: December 5th - Check your email!
                    </div>
                </div>
            </div>

            <!-- WHAT HAPPENS NEXT -->
            <div class="info-box" style="text-align: center; padding: 30px 20px;">
                <h2 style="color: #c41e3a; margin-bottom: 20px;">âœ¨ What Happens Next? âœ¨</h2>
                
                <div style="background: #fff3cd; border: 2px dashed #c41e3a; border-radius: 15px; padding: 25px; margin: 20px 0;">
                    <ul style="text-align: left; font-size: 16px; line-height: 2;">
                        <li>âœ… Your registration is confirmed!</li>
                        <li>ğŸ² Once everyone signs up (by Dec 5th), we'll randomly assign Secret Santas</li>
                        <li>ğŸ’Œ You'll receive an email with your assigned person's name and their gift preferences</li>
                        <li>ğŸ Shop for your Secret Santa (remember: ~$25 budget!)</li>
                        <li>ğŸ€ Wrap your gift in red wrapping paper and bring it to the party on Dec 19th!</li>
                        <li>ğŸ‰ Join us for food, fun, and gift exchange at 1:00 PM!</li>
                    </ul>
                </div>

                <p style="font-size: 16px; color: #666; margin-top: 20px;">
                    âš ï¸ <strong>Check your email inbox</strong> (and spam folder!) for your Secret Santa assignment!
                </p>
            </div>

            <!-- POTLUCK SECTION -->
            <div class="potluck-section">
                <h3>ğŸ• Potluck Contribution ğŸ•</h3>
                <p style="text-align: center; font-size: 16px; margin-bottom: 20px;">
                    We're having a potluck-style party on <strong>December 19th</strong>! To make sure we have a great variety of food, please let us know what type of dish you'd like to bring. This way, we won't end up with 10 desserts and no main courses! ğŸ˜„
                </p>

                <form id="potluckForm">
                    <input type="hidden" id="potluckEmail" value="">
                    
                    <div class="food-options">
                        <div class="food-option" onclick="document.getElementById('main').checked = true;">
                            <input type="radio" id="main" name="foodType" value="Main Course" required>
                            <label for="main">ğŸ— Main Course</label>
                            <div class="percentage-bar">
                                <div class="percentage-fill" id="percent-main" style="width: 0%"></div>
                            </div>
                            <small class="percentage-text" id="text-main">0%</small>
                        </div>
                        <div class="food-option" onclick="document.getElementById('appetizer').checked = true;">
                            <input type="radio" id="appetizer" name="foodType" value="Appetizer">
                            <label for="appetizer">ğŸ¥— Appetizer</label>
                            <div class="percentage-bar">
                                <div class="percentage-fill" id="percent-appetizer" style="width: 0%"></div>
                            </div>
                            <small class="percentage-text" id="text-appetizer">0%</small>
                        </div>
                        <div class="food-option" onclick="document.getElementById('dessert').checked = true;">
                            <input type="radio" id="dessert" name="foodType" value="Dessert">
                            <label for="dessert">ğŸ° Dessert</label>
                            <div class="percentage-bar">
                                <div class="percentage-fill" id="percent-dessert" style="width: 0%"></div>
                            </div>
                            <small class="percentage-text" id="text-dessert">0%</small>
                        </div>
                        <div class="food-option" onclick="document.getElementById('snacks').checked = true;">
                            <input type="radio" id="snacks" name="foodType" value="Snacks">
                            <label for="snacks">ğŸ¿ Snacks</label>
                            <div class="percentage-bar">
                                <div class="percentage-fill" id="percent-snacks" style="width: 0%"></div>
                            </div>
                            <small class="percentage-text" id="text-snacks">0%</small>
                        </div>
                        <div class="food-option" onclick="document.getElementById('drinks').checked = true;">
                            <input type="radio" id="drinks" name="foodType" value="Drinks">
                            <label for="drinks">ğŸ¥¤ Drinks</label>
                            <div class="percentage-bar">
                                <div class="percentage-fill" id="percent-drinks" style="width: 0%"></div>
                            </div>
                            <small class="percentage-text" id="text-drinks">0%</small>
                        </div>
                        <div class="food-option" onclick="document.getElementById('notbringing').checked = true;">
                            <input type="radio" id="notbringing" name="foodType" value="Not Bringing Food">
                            <label for="notbringing">âŒ Can't Bring Food</label>
                            <div class="percentage-bar">
                                <div class="percentage-fill" id="percent-notbringing" style="width: 0%"></div>
                            </div>
                            <small class="percentage-text" id="text-notbringing">0%</small>
                        </div>
                    </div>

                    <div style="text-align: center;">
                        <button type="submit" class="submit-potluck-btn">ğŸ‰ SUBMIT MY CHOICE ğŸ‰</button>
                    </div>

                    <div id="potluckSuccess" style="display: none; text-align: center; margin-top: 20px; color: #28a745; font-weight: bold;">
                        âœ… Thank you! Your potluck choice has been saved!
                    </div>
                </form>
            </div>

            <!-- DRESS CODE -->
            <div class="dress-code-box">
                <h3 style="color: #FFD700; text-align: center; margin-bottom: 15px;">ğŸ… Dress Code: Festive & Fun! ğŸ„</h3>
                <p style="font-size: 16px; line-height: 1.8;">
                    Let's make this party extra special! If you can, wear something Christmas-themed â€“ whether it's an ugly Christmas sweater, festive colors (red, green, gold), Santa hat, reindeer antlers, or even jingle bell earrings! Let's spread the holiday cheer with our outfits! ğŸâœ¨
                </p>
                <p style="text-align: center; margin-top: 15px; font-size: 14px; font-style: italic;">
                    (Not mandatory, but highly encouraged for maximum festive vibes! ğŸ‰)
                </p>
            </div>

            <!-- GIFT WRAPPING NOTE -->
            <div style="background: #e8f5e9; border: 2px solid #4caf50; border-radius: 15px; padding: 25px; margin: 25px 0;">
                <h3 style="color: #2e7d32; text-align: center; margin-bottom: 15px;">ğŸ Gift Wrapping Reminder ğŸ</h3>
                <p style="text-align: center; font-size: 16px; line-height: 1.8;">
                    Please wrap your Secret Santa gift in red wrapping paper before bringing it to the party! Part of the fun is the surprise and presentation â€“ let's keep it festive and uniform with a beautiful red theme! Add ribbons and bows to make it look magical! ğŸ€âœ¨
                </p>
            </div>

            <!-- TOP SECRET WARNING -->
            <div class="warning-box">
                <h3>ğŸ¤« TOP SECRET: CLASSIFIED INFORMATION ğŸ¤«</h3>
                <p style="font-size: 18px; line-height: 1.8; margin: 15px 0;">
                    <strong>âš ï¸ ATTENTION ALL SECRET SANTAS âš ï¸</strong>
                </p>
                <p style="font-size: 16px; line-height: 1.8;">
                    Once you receive your Secret Santa assignment, your mission is to keep it <strong>ABSOLUTELY SECRET</strong>! No hints, no winks, no "accidentally" revealing who you got. The magic of Secret Santa is in the mystery! ğŸ•µï¸â€â™‚ï¸
                </p>
                <p style="font-size: 16px; line-height: 1.8; margin-top: 15px; font-weight: bold; color: #c41e3a;">
                    ğŸš¨ Breaking the secrecy code may result in being put on Santa's naughty list! ğŸš¨
                </p>
                <p style="font-size: 14px; margin-top: 15px; font-style: italic;">
                    (Just kidding... but seriously, keep it secret! It's way more fun that way! ğŸ˜„)
                </p>
            </div>

            <!-- FOOTER -->
            <div style="text-align: center; margin-top: 40px; font-size: 48px;">
                ğŸ… ğŸ„ â„ï¸ ğŸ â›„
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <a href="index.html" class="btn" style="display: inline-block; text-decoration: none;">
                    ğŸ  Back to Home
                </a>
            </div>
        </div>
    </div>

<script>
    // Load potluck stats
    async function loadPotluckStats() {
        try {
            const response = await fetch('/.netlify/functions/getpotluckstats');
            const data = await response.json();
            
            if (data.percentages) {
                updatePercentage('main', data.percentages['Main Course'] || 0);
                updatePercentage('appetizer', data.percentages['Appetizer'] || 0);
                updatePercentage('dessert', data.percentages['Dessert'] || 0);
                updatePercentage('snacks', data.percentages['Snacks'] || 0);
                updatePercentage('drinks', data.percentages['Drinks'] || 0);
                updatePercentage('notbringing', data.percentages['Not Bringing Food'] || 0);
            }
        } catch (error) {
            console.error('Error loading stats:', error);
        }
    }

    function updatePercentage(id, percent) {
        const fill = document.getElementById('percent-' + id);
        const text = document.getElementById('text-' + id);
        if (fill && text) {
            fill.style.width = percent + '%';
            text.textContent = percent + '%';
        }
    }

    // Load stats when page loads
    loadPotluckStats();
    
    // Refresh stats every 10 seconds
    setInterval(loadPotluckStats, 10000);

    // Get user email from URL or session
    const urlParams = new URLSearchParams(window.location.search);
    const userEmail = urlParams.get('email') || sessionStorage.getItem('userEmail') || '';
    document.getElementById('potluckEmail').value = userEmail;

    // Handle potluck form submit
    document.getElementById('potluckForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Get email (check URL params first, then session, then hidden field)
        const email = urlParams.get('email') || sessionStorage.getItem('userEmail') || document.getElementById('potluckEmail').value || '';
        
        const selectedFood = document.querySelector('input[name="foodType"]:checked');
        
        if (!selectedFood) {
            alert('Please select a food option!');
            return;
        }

        if (!email || email.trim() === '') {
            alert('Missing email. Please open this page from your signup confirmation email link.');
            return;
        }

        const btn = e.target.querySelector('.submit-potluck-btn');
        btn.disabled = true;
        btn.textContent = 'Saving... ğŸ„';

        console.log('Submitting potluck:', { email, potluckChoice: selectedFood.value });

        try {
            const response = await fetch('/.netlify/functions/updatepotluck', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: email,
                    potluckChoice: selectedFood.value
                })
            });

            const text = await response.text();
            console.log('Response:', response.status, text);

            if (response.ok) {
                document.getElementById('potluckSuccess').style.display = 'block';
                btn.textContent = 'âœ… Saved!';
                btn.style.background = '#28a745';
                
                // Disable all radio buttons after successful submit
                document.querySelectorAll('input[name="foodType"]').forEach(input => {
                    input.disabled = true;
                });
                
                // Reload stats after 500ms to show updated percentages
                setTimeout(() => {
                    loadPotluckStats();
                }, 500);
            } else {
                throw new Error(text || 'Server returned error');
            }
        } catch (error) {
            console.error('Potluck save error:', error);
            alert('Error saving your choice. Please try again!');
            btn.disabled = false;
            btn.textContent = 'ğŸ‰ SUBMIT MY CHOICE ğŸ‰';
        }
    });

    // Snow animation
    function createInteractiveSnow() {
        const snowflakes = [];
        const maxSnowflakes = 80;
        
        for (let i = 0; i < maxSnowflakes; i++) {
            createSingleSnowflake(snowflakes, true);
        }
        
        let mouseX = -1000;
        let mouseY = -1000;
        
        document.addEventListener('mousemove', function(e) {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });
        
        function animate() {
            snowflakes.forEach(function(snow) {
                snow.velocityY += 0.02;
                snow.x += Math.sin(snow.y * 0.01 + snow.offset) * 0.3;
                
                const dx = snow.x - mouseX;
                const dy = snow.y - mouseY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 120 && distance > 0) {
                    const force = (120 - distance) / 120;
                    const pushStrength = force * force * 8;
                    snow.velocityX += (dx / distance) * pushStrength * 0.3;
                    snow.velocityY += (dy / distance) * pushStrength * 0.2;
                }
                
                snow.velocityX *= 0.92;
                snow.velocityY *= 0.98;
                
                if (snow.velocityY > 3) snow.velocityY = 3;
                if (snow.velocityY < 0.3) snow.velocityY = 0.3;
                
                snow.x += snow.velocityX;
                snow.y += snow.velocityY;
                
                if (snow.x < -20) snow.x = window.innerWidth + 20;
                if (snow.x > window.innerWidth + 20) snow.x = -20;
                if (snow.y > window.innerHeight + 20) resetSnowflake(snow);
                if (snow.y < -100) resetSnowflake(snow);
                
                snow.element.style.left = snow.x + 'px';
                snow.element.style.top = snow.y + 'px';
            });
            
            requestAnimationFrame(animate);
        }
        
        animate();
    }

    function createSingleSnowflake(snowflakes, randomStart) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.textContent = ['â„', 'â…', 'â†'][Math.floor(Math.random() * 3)];
        document.body.appendChild(snowflake);
        
        const snow = {
            element: snowflake,
            x: Math.random() * window.innerWidth,
            y: randomStart ? Math.random() * window.innerHeight : (-20 - Math.random() * 100),
            velocityX: 0,
            velocityY: Math.random() * 0.5 + 0.5,
            size: Math.random() * 10 + 15,
            offset: Math.random() * 1000
        };
        
        snowflake.style.fontSize = snow.size + 'px';
        snowflake.style.opacity = Math.random() * 0.4 + 0.6;
        snowflakes.push(snow);
    }

    function resetSnowflake(snow) {
        snow.x = Math.random() * window.innerWidth;
        snow.y = -20 - Math.random() * 50;
        snow.velocityX = 0;
        snow.velocityY = Math.random() * 0.5 + 0.5;
        snow.offset = Math.random() * 1000;
    }

    createInteractiveSnow();
</script>
</body>
</html>





